var vt=Object.defineProperty;var Me=e=>{throw TypeError(e)};var wt=(e,t,r)=>t in e?vt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var p=(e,t,r)=>wt(e,typeof t!="symbol"?t+"":t,r),$e=(e,t,r)=>t.has(e)||Me("Cannot "+r);var o=(e,t,r)=>($e(e,t,"read from private field"),r?r.call(e):t.get(e)),m=(e,t,r)=>t.has(e)?Me("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),d=(e,t,r,s)=>($e(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),v=(e,t,r)=>($e(e,t,"access private method"),r);var Fe=(e,t,r,s)=>({set _(n){d(e,t,n,r)},get _(){return o(e,t,s)}});var Ue=(e,t,r)=>(s,n)=>{let i=-1;return a(0);async function a(h){if(h<=i)throw new Error("next() called multiple times");i=h;let l,c=!1,f;if(e[h]?(f=e[h][0][0],s.req.routeIndex=h):f=h===e.length&&n||void 0,f)try{l=await f(s,()=>a(h+1))}catch(u){if(u instanceof Error&&t)s.error=u,l=await t(u,s),c=!0;else throw u}else s.finalized===!1&&r&&(l=await r(s));return l&&(s.finalized===!1||c)&&(s.res=l),s}},yt=Symbol(),bt=async(e,t=Object.create(null))=>{const{all:r=!1,dot:s=!1}=t,i=(e instanceof st?e.raw.headers:e.headers).get("Content-Type");return i!=null&&i.startsWith("multipart/form-data")||i!=null&&i.startsWith("application/x-www-form-urlencoded")?Et(e,{all:r,dot:s}):{}};async function Et(e,t){const r=await e.formData();return r?Rt(r,t):{}}function Rt(e,t){const r=Object.create(null);return e.forEach((s,n)=>{t.all||n.endsWith("[]")?St(r,n,s):r[n]=s}),t.dot&&Object.entries(r).forEach(([s,n])=>{s.includes(".")&&(jt(r,s,n),delete r[s])}),r}var St=(e,t,r)=>{e[t]!==void 0?Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:t.endsWith("[]")?e[t]=[r]:e[t]=r},jt=(e,t,r)=>{let s=e;const n=t.split(".");n.forEach((i,a)=>{a===n.length-1?s[i]=r:((!s[i]||typeof s[i]!="object"||Array.isArray(s[i])||s[i]instanceof File)&&(s[i]=Object.create(null)),s=s[i])})},Qe=e=>{const t=e.split("/");return t[0]===""&&t.shift(),t},Ot=e=>{const{groups:t,path:r}=Ct(e),s=Qe(r);return At(s,t)},Ct=e=>{const t=[];return e=e.replace(/\{[^}]+\}/g,(r,s)=>{const n=`@${s}`;return t.push([n,r]),n}),{groups:t,path:e}},At=(e,t)=>{for(let r=t.length-1;r>=0;r--){const[s]=t[r];for(let n=e.length-1;n>=0;n--)if(e[n].includes(s)){e[n]=e[n].replace(s,t[r][1]);break}}return e},je={},Tt=(e,t)=>{if(e==="*")return"*";const r=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(r){const s=`${e}#${t}`;return je[s]||(r[2]?je[s]=t&&t[0]!==":"&&t[0]!=="*"?[s,r[1],new RegExp(`^${r[2]}(?=/${t})`)]:[e,r[1],new RegExp(`^${r[2]}$`)]:je[s]=[e,r[1],!0]),je[s]}return null},Le=(e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,r=>{try{return t(r)}catch{return r}})}},Pt=e=>Le(e,decodeURI),Ze=e=>{const t=e.url,r=t.indexOf("/",t.indexOf(":")+4);let s=r;for(;s<t.length;s++){const n=t.charCodeAt(s);if(n===37){const i=t.indexOf("?",s),a=t.slice(r,i===-1?void 0:i);return Pt(a.includes("%25")?a.replace(/%25/g,"%2525"):a)}else if(n===63)break}return t.slice(r,s)},Nt=e=>{const t=Ze(e);return t.length>1&&t.at(-1)==="/"?t.slice(0,-1):t},se=(e,t,...r)=>(r.length&&(t=se(t,...r)),`${(e==null?void 0:e[0])==="/"?"":"/"}${e}${t==="/"?"":`${(e==null?void 0:e.at(-1))==="/"?"":"/"}${(t==null?void 0:t[0])==="/"?t.slice(1):t}`}`),et=e=>{if(e.charCodeAt(e.length-1)!==63||!e.includes(":"))return null;const t=e.split("/"),r=[];let s="";return t.forEach(n=>{if(n!==""&&!/\:/.test(n))s+="/"+n;else if(/\:/.test(n))if(/\?/.test(n)){r.length===0&&s===""?r.push("/"):r.push(s);const i=n.replace("?","");s+="/"+i,r.push(s)}else s+="/"+n}),r.filter((n,i,a)=>a.indexOf(n)===i)},_e=e=>/[%+]/.test(e)?(e.indexOf("+")!==-1&&(e=e.replace(/\+/g," ")),e.indexOf("%")!==-1?Le(e,rt):e):e,tt=(e,t,r)=>{let s;if(!r&&t&&!/[%+]/.test(t)){let a=e.indexOf("?",8);if(a===-1)return;for(e.startsWith(t,a+1)||(a=e.indexOf(`&${t}`,a+1));a!==-1;){const h=e.charCodeAt(a+t.length+1);if(h===61){const l=a+t.length+2,c=e.indexOf("&",l);return _e(e.slice(l,c===-1?void 0:c))}else if(h==38||isNaN(h))return"";a=e.indexOf(`&${t}`,a+1)}if(s=/[%+]/.test(e),!s)return}const n={};s??(s=/[%+]/.test(e));let i=e.indexOf("?",8);for(;i!==-1;){const a=e.indexOf("&",i+1);let h=e.indexOf("=",i);h>a&&a!==-1&&(h=-1);let l=e.slice(i+1,h===-1?a===-1?void 0:a:h);if(s&&(l=_e(l)),i=a,l==="")continue;let c;h===-1?c="":(c=e.slice(h+1,a===-1?void 0:a),s&&(c=_e(c))),r?(n[l]&&Array.isArray(n[l])||(n[l]=[]),n[l].push(c)):n[l]??(n[l]=c)}return t?n[t]:n},Ht=tt,$t=(e,t)=>tt(e,t,!0),rt=decodeURIComponent,qe=e=>Le(e,rt),ae,A,I,nt,it,ke,U,Ge,st=(Ge=class{constructor(e,t="/",r=[[]]){m(this,I);p(this,"raw");m(this,ae);m(this,A);p(this,"routeIndex",0);p(this,"path");p(this,"bodyCache",{});m(this,U,e=>{const{bodyCache:t,raw:r}=this,s=t[e];if(s)return s;const n=Object.keys(t)[0];return n?t[n].then(i=>(n==="json"&&(i=JSON.stringify(i)),new Response(i)[e]())):t[e]=r[e]()});this.raw=e,this.path=t,d(this,A,r),d(this,ae,{})}param(e){return e?v(this,I,nt).call(this,e):v(this,I,it).call(this)}query(e){return Ht(this.url,e)}queries(e){return $t(this.url,e)}header(e){if(e)return this.raw.headers.get(e)??void 0;const t={};return this.raw.headers.forEach((r,s)=>{t[s]=r}),t}async parseBody(e){var t;return(t=this.bodyCache).parsedBody??(t.parsedBody=await bt(this,e))}json(){return o(this,U).call(this,"text").then(e=>JSON.parse(e))}text(){return o(this,U).call(this,"text")}arrayBuffer(){return o(this,U).call(this,"arrayBuffer")}blob(){return o(this,U).call(this,"blob")}formData(){return o(this,U).call(this,"formData")}addValidatedData(e,t){o(this,ae)[e]=t}valid(e){return o(this,ae)[e]}get url(){return this.raw.url}get method(){return this.raw.method}get[yt](){return o(this,A)}get matchedRoutes(){return o(this,A)[0].map(([[,e]])=>e)}get routePath(){return o(this,A)[0].map(([[,e]])=>e)[this.routeIndex].path}},ae=new WeakMap,A=new WeakMap,I=new WeakSet,nt=function(e){const t=o(this,A)[0][this.routeIndex][1][e],r=v(this,I,ke).call(this,t);return r&&/\%/.test(r)?qe(r):r},it=function(){const e={},t=Object.keys(o(this,A)[0][this.routeIndex][1]);for(const r of t){const s=v(this,I,ke).call(this,o(this,A)[0][this.routeIndex][1][r]);s!==void 0&&(e[r]=/\%/.test(s)?qe(s):s)}return e},ke=function(e){return o(this,A)[1]?o(this,A)[1][e]:e},U=new WeakMap,Ge),_t={Stringify:1},at=async(e,t,r,s,n)=>{typeof e=="object"&&!(e instanceof String)&&(e instanceof Promise||(e=e.toString()),e instanceof Promise&&(e=await e));const i=e.callbacks;return i!=null&&i.length?(n?n[0]+=e:n=[e],Promise.all(i.map(h=>h({phase:t,buffer:n,context:s}))).then(h=>Promise.all(h.filter(Boolean).map(l=>at(l,t,!1,s,n))).then(()=>n[0]))):Promise.resolve(e)},Dt="text/plain; charset=UTF-8",De=(e,t)=>({"Content-Type":e,...t}),xe,ve,_,oe,D,O,we,ce,le,X,ye,be,q,ne,Ke,kt=(Ke=class{constructor(e,t){m(this,q);m(this,xe);m(this,ve);p(this,"env",{});m(this,_);p(this,"finalized",!1);p(this,"error");m(this,oe);m(this,D);m(this,O);m(this,we);m(this,ce);m(this,le);m(this,X);m(this,ye);m(this,be);p(this,"render",(...e)=>(o(this,ce)??d(this,ce,t=>this.html(t)),o(this,ce).call(this,...e)));p(this,"setLayout",e=>d(this,we,e));p(this,"getLayout",()=>o(this,we));p(this,"setRenderer",e=>{d(this,ce,e)});p(this,"header",(e,t,r)=>{this.finalized&&d(this,O,new Response(o(this,O).body,o(this,O)));const s=o(this,O)?o(this,O).headers:o(this,X)??d(this,X,new Headers);t===void 0?s.delete(e):r!=null&&r.append?s.append(e,t):s.set(e,t)});p(this,"status",e=>{d(this,oe,e)});p(this,"set",(e,t)=>{o(this,_)??d(this,_,new Map),o(this,_).set(e,t)});p(this,"get",e=>o(this,_)?o(this,_).get(e):void 0);p(this,"newResponse",(...e)=>v(this,q,ne).call(this,...e));p(this,"body",(e,t,r)=>v(this,q,ne).call(this,e,t,r));p(this,"text",(e,t,r)=>!o(this,X)&&!o(this,oe)&&!t&&!r&&!this.finalized?new Response(e):v(this,q,ne).call(this,e,t,De(Dt,r)));p(this,"json",(e,t,r)=>v(this,q,ne).call(this,JSON.stringify(e),t,De("application/json",r)));p(this,"html",(e,t,r)=>{const s=n=>v(this,q,ne).call(this,n,t,De("text/html; charset=UTF-8",r));return typeof e=="object"?at(e,_t.Stringify,!1,{}).then(s):s(e)});p(this,"redirect",(e,t)=>{const r=String(e);return this.header("Location",/[^\x00-\xFF]/.test(r)?encodeURI(r):r),this.newResponse(null,t??302)});p(this,"notFound",()=>(o(this,le)??d(this,le,()=>new Response),o(this,le).call(this,this)));d(this,xe,e),t&&(d(this,D,t.executionCtx),this.env=t.env,d(this,le,t.notFoundHandler),d(this,be,t.path),d(this,ye,t.matchResult))}get req(){return o(this,ve)??d(this,ve,new st(o(this,xe),o(this,be),o(this,ye))),o(this,ve)}get event(){if(o(this,D)&&"respondWith"in o(this,D))return o(this,D);throw Error("This context has no FetchEvent")}get executionCtx(){if(o(this,D))return o(this,D);throw Error("This context has no ExecutionContext")}get res(){return o(this,O)||d(this,O,new Response(null,{headers:o(this,X)??d(this,X,new Headers)}))}set res(e){if(o(this,O)&&e){e=new Response(e.body,e);for(const[t,r]of o(this,O).headers.entries())if(t!=="content-type")if(t==="set-cookie"){const s=o(this,O).headers.getSetCookie();e.headers.delete("set-cookie");for(const n of s)e.headers.append("set-cookie",n)}else e.headers.set(t,r)}d(this,O,e),this.finalized=!0}get var(){return o(this,_)?Object.fromEntries(o(this,_)):{}}},xe=new WeakMap,ve=new WeakMap,_=new WeakMap,oe=new WeakMap,D=new WeakMap,O=new WeakMap,we=new WeakMap,ce=new WeakMap,le=new WeakMap,X=new WeakMap,ye=new WeakMap,be=new WeakMap,q=new WeakSet,ne=function(e,t,r){const s=o(this,O)?new Headers(o(this,O).headers):o(this,X)??new Headers;if(typeof t=="object"&&"headers"in t){const i=t.headers instanceof Headers?t.headers:new Headers(t.headers);for(const[a,h]of i)a.toLowerCase()==="set-cookie"?s.append(a,h):s.set(a,h)}if(r)for(const[i,a]of Object.entries(r))if(typeof a=="string")s.set(i,a);else{s.delete(i);for(const h of a)s.append(i,h)}const n=typeof t=="number"?t:(t==null?void 0:t.status)??o(this,oe);return new Response(e,{status:n,headers:s})},Ke),b="ALL",Lt="all",It=["get","post","put","delete","options","patch"],ot="Can not add a route since the matcher is already built.",ct=class extends Error{},Mt="__COMPOSED_HANDLER",Ft=e=>e.text("404 Not Found",404),ze=(e,t)=>{if("getResponse"in e){const r=e.getResponse();return t.newResponse(r.body,r)}return console.error(e),t.text("Internal Server Error",500)},T,E,lt,P,V,Oe,Ce,he,Ut=(he=class{constructor(t={}){m(this,E);p(this,"get");p(this,"post");p(this,"put");p(this,"delete");p(this,"options");p(this,"patch");p(this,"all");p(this,"on");p(this,"use");p(this,"router");p(this,"getPath");p(this,"_basePath","/");m(this,T,"/");p(this,"routes",[]);m(this,P,Ft);p(this,"errorHandler",ze);p(this,"onError",t=>(this.errorHandler=t,this));p(this,"notFound",t=>(d(this,P,t),this));p(this,"fetch",(t,...r)=>v(this,E,Ce).call(this,t,r[1],r[0],t.method));p(this,"request",(t,r,s,n)=>t instanceof Request?this.fetch(r?new Request(t,r):t,s,n):(t=t.toString(),this.fetch(new Request(/^https?:\/\//.test(t)?t:`http://localhost${se("/",t)}`,r),s,n)));p(this,"fire",()=>{addEventListener("fetch",t=>{t.respondWith(v(this,E,Ce).call(this,t.request,t,void 0,t.request.method))})});[...It,Lt].forEach(i=>{this[i]=(a,...h)=>(typeof a=="string"?d(this,T,a):v(this,E,V).call(this,i,o(this,T),a),h.forEach(l=>{v(this,E,V).call(this,i,o(this,T),l)}),this)}),this.on=(i,a,...h)=>{for(const l of[a].flat()){d(this,T,l);for(const c of[i].flat())h.map(f=>{v(this,E,V).call(this,c.toUpperCase(),o(this,T),f)})}return this},this.use=(i,...a)=>(typeof i=="string"?d(this,T,i):(d(this,T,"*"),a.unshift(i)),a.forEach(h=>{v(this,E,V).call(this,b,o(this,T),h)}),this);const{strict:s,...n}=t;Object.assign(this,n),this.getPath=s??!0?t.getPath??Ze:Nt}route(t,r){const s=this.basePath(t);return r.routes.map(n=>{var a;let i;r.errorHandler===ze?i=n.handler:(i=async(h,l)=>(await Ue([],r.errorHandler)(h,()=>n.handler(h,l))).res,i[Mt]=n.handler),v(a=s,E,V).call(a,n.method,n.path,i)}),this}basePath(t){const r=v(this,E,lt).call(this);return r._basePath=se(this._basePath,t),r}mount(t,r,s){let n,i;s&&(typeof s=="function"?i=s:(i=s.optionHandler,s.replaceRequest===!1?n=l=>l:n=s.replaceRequest));const a=i?l=>{const c=i(l);return Array.isArray(c)?c:[c]}:l=>{let c;try{c=l.executionCtx}catch{}return[l.env,c]};n||(n=(()=>{const l=se(this._basePath,t),c=l==="/"?0:l.length;return f=>{const u=new URL(f.url);return u.pathname=u.pathname.slice(c)||"/",new Request(u,f)}})());const h=async(l,c)=>{const f=await r(n(l.req.raw),...a(l));if(f)return f;await c()};return v(this,E,V).call(this,b,se(t,"*"),h),this}},T=new WeakMap,E=new WeakSet,lt=function(){const t=new he({router:this.router,getPath:this.getPath});return t.errorHandler=this.errorHandler,d(t,P,o(this,P)),t.routes=this.routes,t},P=new WeakMap,V=function(t,r,s){t=t.toUpperCase(),r=se(this._basePath,r);const n={basePath:this._basePath,path:r,method:t,handler:s};this.router.add(t,r,[s,n]),this.routes.push(n)},Oe=function(t,r){if(t instanceof Error)return this.errorHandler(t,r);throw t},Ce=function(t,r,s,n){if(n==="HEAD")return(async()=>new Response(null,await v(this,E,Ce).call(this,t,r,s,"GET")))();const i=this.getPath(t,{env:s}),a=this.router.match(n,i),h=new kt(t,{path:i,matchResult:a,env:s,executionCtx:r,notFoundHandler:o(this,P)});if(a[0].length===1){let c;try{c=a[0][0][0][0](h,async()=>{h.res=await o(this,P).call(this,h)})}catch(f){return v(this,E,Oe).call(this,f,h)}return c instanceof Promise?c.then(f=>f||(h.finalized?h.res:o(this,P).call(this,h))).catch(f=>v(this,E,Oe).call(this,f,h)):c??o(this,P).call(this,h)}const l=Ue(a[0],this.errorHandler,o(this,P));return(async()=>{try{const c=await l(h);if(!c.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return c.res}catch(c){return v(this,E,Oe).call(this,c,h)}})()},he),ht=[];function qt(e,t){const r=this.buildAllMatchers(),s=((n,i)=>{const a=r[n]||r[b],h=a[2][i];if(h)return h;const l=i.match(a[0]);if(!l)return[[],ht];const c=l.indexOf("",1);return[a[1][c],l]});return this.match=s,s(e,t)}var Te="[^/]+",ge=".*",me="(?:|/.*)",ie=Symbol(),zt=new Set(".\\+*[^]$()");function Bt(e,t){return e.length===1?t.length===1?e<t?-1:1:-1:t.length===1||e===ge||e===me?1:t===ge||t===me?-1:e===Te?1:t===Te?-1:e.length===t.length?e<t?-1:1:t.length-e.length}var Y,Q,N,te,Wt=(te=class{constructor(){m(this,Y);m(this,Q);m(this,N,Object.create(null))}insert(t,r,s,n,i){if(t.length===0){if(o(this,Y)!==void 0)throw ie;if(i)return;d(this,Y,r);return}const[a,...h]=t,l=a==="*"?h.length===0?["","",ge]:["","",Te]:a==="/*"?["","",me]:a.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);let c;if(l){const f=l[1];let u=l[2]||Te;if(f&&l[2]&&(u===".*"||(u=u.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(u))))throw ie;if(c=o(this,N)[u],!c){if(Object.keys(o(this,N)).some(g=>g!==ge&&g!==me))throw ie;if(i)return;c=o(this,N)[u]=new te,f!==""&&d(c,Q,n.varIndex++)}!i&&f!==""&&s.push([f,o(c,Q)])}else if(c=o(this,N)[a],!c){if(Object.keys(o(this,N)).some(f=>f.length>1&&f!==ge&&f!==me))throw ie;if(i)return;c=o(this,N)[a]=new te}c.insert(h,r,s,n,i)}buildRegExpStr(){const r=Object.keys(o(this,N)).sort(Bt).map(s=>{const n=o(this,N)[s];return(typeof o(n,Q)=="number"?`(${s})@${o(n,Q)}`:zt.has(s)?`\\${s}`:s)+n.buildRegExpStr()});return typeof o(this,Y)=="number"&&r.unshift(`#${o(this,Y)}`),r.length===0?"":r.length===1?r[0]:"(?:"+r.join("|")+")"}},Y=new WeakMap,Q=new WeakMap,N=new WeakMap,te),Pe,Ee,Ve,Gt=(Ve=class{constructor(){m(this,Pe,{varIndex:0});m(this,Ee,new Wt)}insert(e,t,r){const s=[],n=[];for(let a=0;;){let h=!1;if(e=e.replace(/\{[^}]+\}/g,l=>{const c=`@\\${a}`;return n[a]=[c,l],a++,h=!0,c}),!h)break}const i=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let a=n.length-1;a>=0;a--){const[h]=n[a];for(let l=i.length-1;l>=0;l--)if(i[l].indexOf(h)!==-1){i[l]=i[l].replace(h,n[a][1]);break}}return o(this,Ee).insert(i,t,s,o(this,Pe),r),s}buildRegExp(){let e=o(this,Ee).buildRegExpStr();if(e==="")return[/^$/,[],[]];let t=0;const r=[],s=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(n,i,a)=>i!==void 0?(r[++t]=Number(i),"$()"):(a!==void 0&&(s[Number(a)]=++t),"")),[new RegExp(`^${e}`),r,s]}},Pe=new WeakMap,Ee=new WeakMap,Ve),Kt=[/^$/,[],Object.create(null)],Ae=Object.create(null);function ft(e){return Ae[e]??(Ae[e]=new RegExp(e==="*"?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,(t,r)=>r?`\\${r}`:"(?:|/.*)")}$`))}function Vt(){Ae=Object.create(null)}function Jt(e){var c;const t=new Gt,r=[];if(e.length===0)return Kt;const s=e.map(f=>[!/\*|\/:/.test(f[0]),...f]).sort(([f,u],[g,w])=>f?1:g?-1:u.length-w.length),n=Object.create(null);for(let f=0,u=-1,g=s.length;f<g;f++){const[w,y,C]=s[f];w?n[y]=[C.map(([R])=>[R,Object.create(null)]),ht]:u++;let x;try{x=t.insert(y,u,w)}catch(R){throw R===ie?new ct(y):R}w||(r[u]=C.map(([R,M])=>{const Re=Object.create(null);for(M-=1;M>=0;M--){const[Se,H]=x[M];Re[Se]=H}return[R,Re]}))}const[i,a,h]=t.buildRegExp();for(let f=0,u=r.length;f<u;f++)for(let g=0,w=r[f].length;g<w;g++){const y=(c=r[f][g])==null?void 0:c[1];if(!y)continue;const C=Object.keys(y);for(let x=0,R=C.length;x<R;x++)y[C[x]]=h[y[C[x]]]}const l=[];for(const f in a)l[f]=r[a[f]];return[i,l,n]}function re(e,t){if(e){for(const r of Object.keys(e).sort((s,n)=>n.length-s.length))if(ft(r).test(t))return[...e[r]]}}var z,B,Ne,ut,Je,Xt=(Je=class{constructor(){m(this,Ne);p(this,"name","RegExpRouter");m(this,z);m(this,B);p(this,"match",qt);d(this,z,{[b]:Object.create(null)}),d(this,B,{[b]:Object.create(null)})}add(e,t,r){var h;const s=o(this,z),n=o(this,B);if(!s||!n)throw new Error(ot);s[e]||[s,n].forEach(l=>{l[e]=Object.create(null),Object.keys(l[b]).forEach(c=>{l[e][c]=[...l[b][c]]})}),t==="/*"&&(t="*");const i=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){const l=ft(t);e===b?Object.keys(s).forEach(c=>{var f;(f=s[c])[t]||(f[t]=re(s[c],t)||re(s[b],t)||[])}):(h=s[e])[t]||(h[t]=re(s[e],t)||re(s[b],t)||[]),Object.keys(s).forEach(c=>{(e===b||e===c)&&Object.keys(s[c]).forEach(f=>{l.test(f)&&s[c][f].push([r,i])})}),Object.keys(n).forEach(c=>{(e===b||e===c)&&Object.keys(n[c]).forEach(f=>l.test(f)&&n[c][f].push([r,i]))});return}const a=et(t)||[t];for(let l=0,c=a.length;l<c;l++){const f=a[l];Object.keys(n).forEach(u=>{var g;(e===b||e===u)&&((g=n[u])[f]||(g[f]=[...re(s[u],f)||re(s[b],f)||[]]),n[u][f].push([r,i-c+l+1]))})}}buildAllMatchers(){const e=Object.create(null);return Object.keys(o(this,B)).concat(Object.keys(o(this,z))).forEach(t=>{e[t]||(e[t]=v(this,Ne,ut).call(this,t))}),d(this,z,d(this,B,void 0)),Vt(),e}},z=new WeakMap,B=new WeakMap,Ne=new WeakSet,ut=function(e){const t=[];let r=e===b;return[o(this,z),o(this,B)].forEach(s=>{const n=s[e]?Object.keys(s[e]).map(i=>[i,s[e][i]]):[];n.length!==0?(r||(r=!0),t.push(...n)):e!==b&&t.push(...Object.keys(s[b]).map(i=>[i,s[b][i]]))}),r?Jt(t):null},Je),W,k,Xe,Yt=(Xe=class{constructor(e){p(this,"name","SmartRouter");m(this,W,[]);m(this,k,[]);d(this,W,e.routers)}add(e,t,r){if(!o(this,k))throw new Error(ot);o(this,k).push([e,t,r])}match(e,t){if(!o(this,k))throw new Error("Fatal error");const r=o(this,W),s=o(this,k),n=r.length;let i=0,a;for(;i<n;i++){const h=r[i];try{for(let l=0,c=s.length;l<c;l++)h.add(...s[l]);a=h.match(e,t)}catch(l){if(l instanceof ct)continue;throw l}this.match=h.match.bind(h),d(this,W,[h]),d(this,k,void 0);break}if(i===n)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,a}get activeRouter(){if(o(this,k)||o(this,W).length!==1)throw new Error("No active router has been determined yet.");return o(this,W)[0]}},W=new WeakMap,k=new WeakMap,Xe),pe=Object.create(null),G,j,Z,fe,S,L,J,ue,Qt=(ue=class{constructor(t,r,s){m(this,L);m(this,G);m(this,j);m(this,Z);m(this,fe,0);m(this,S,pe);if(d(this,j,s||Object.create(null)),d(this,G,[]),t&&r){const n=Object.create(null);n[t]={handler:r,possibleKeys:[],score:0},d(this,G,[n])}d(this,Z,[])}insert(t,r,s){d(this,fe,++Fe(this,fe)._);let n=this;const i=Ot(r),a=[];for(let h=0,l=i.length;h<l;h++){const c=i[h],f=i[h+1],u=Tt(c,f),g=Array.isArray(u)?u[0]:c;if(g in o(n,j)){n=o(n,j)[g],u&&a.push(u[1]);continue}o(n,j)[g]=new ue,u&&(o(n,Z).push(u),a.push(u[1])),n=o(n,j)[g]}return o(n,G).push({[t]:{handler:s,possibleKeys:a.filter((h,l,c)=>c.indexOf(h)===l),score:o(this,fe)}}),n}search(t,r){var l;const s=[];d(this,S,pe);let i=[this];const a=Qe(r),h=[];for(let c=0,f=a.length;c<f;c++){const u=a[c],g=c===f-1,w=[];for(let y=0,C=i.length;y<C;y++){const x=i[y],R=o(x,j)[u];R&&(d(R,S,o(x,S)),g?(o(R,j)["*"]&&s.push(...v(this,L,J).call(this,o(R,j)["*"],t,o(x,S))),s.push(...v(this,L,J).call(this,R,t,o(x,S)))):w.push(R));for(let M=0,Re=o(x,Z).length;M<Re;M++){const Se=o(x,Z)[M],H=o(x,S)===pe?{}:{...o(x,S)};if(Se==="*"){const F=o(x,j)["*"];F&&(s.push(...v(this,L,J).call(this,F,t,o(x,S))),d(F,S,H),w.push(F));continue}const[mt,Ie,de]=Se;if(!u&&!(de instanceof RegExp))continue;const $=o(x,j)[mt],xt=a.slice(c).join("/");if(de instanceof RegExp){const F=de.exec(xt);if(F){if(H[Ie]=F[0],s.push(...v(this,L,J).call(this,$,t,o(x,S),H)),Object.keys(o($,j)).length){d($,S,H);const He=((l=F[0].match(/\//))==null?void 0:l.length)??0;(h[He]||(h[He]=[])).push($)}continue}}(de===!0||de.test(u))&&(H[Ie]=u,g?(s.push(...v(this,L,J).call(this,$,t,H,o(x,S))),o($,j)["*"]&&s.push(...v(this,L,J).call(this,o($,j)["*"],t,H,o(x,S)))):(d($,S,H),w.push($)))}}i=w.concat(h.shift()??[])}return s.length>1&&s.sort((c,f)=>c.score-f.score),[s.map(({handler:c,params:f})=>[c,f])]}},G=new WeakMap,j=new WeakMap,Z=new WeakMap,fe=new WeakMap,S=new WeakMap,L=new WeakSet,J=function(t,r,s,n){const i=[];for(let a=0,h=o(t,G).length;a<h;a++){const l=o(t,G)[a],c=l[r]||l[b],f={};if(c!==void 0&&(c.params=Object.create(null),i.push(c),s!==pe||n&&n!==pe))for(let u=0,g=c.possibleKeys.length;u<g;u++){const w=c.possibleKeys[u],y=f[c.score];c.params[w]=n!=null&&n[w]&&!y?n[w]:s[w]??(n==null?void 0:n[w]),f[c.score]=!0}}return i},ue),ee,Ye,Zt=(Ye=class{constructor(){p(this,"name","TrieRouter");m(this,ee);d(this,ee,new Qt)}add(e,t,r){const s=et(t);if(s){for(let n=0,i=s.length;n<i;n++)o(this,ee).insert(e,s[n],r);return}o(this,ee).insert(e,t,r)}match(e,t){return o(this,ee).search(e,t)}},ee=new WeakMap,Ye),dt=class extends Ut{constructor(e={}){super(e),this.router=e.router??new Yt({routers:[new Xt,new Zt]})}},er=e=>{const r={...{origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[]},...e},s=(i=>typeof i=="string"?i==="*"?()=>i:a=>i===a?a:null:typeof i=="function"?i:a=>i.includes(a)?a:null)(r.origin),n=(i=>typeof i=="function"?i:Array.isArray(i)?()=>i:()=>[])(r.allowMethods);return async function(a,h){var f;function l(u,g){a.res.headers.set(u,g)}const c=await s(a.req.header("origin")||"",a);if(c&&l("Access-Control-Allow-Origin",c),r.credentials&&l("Access-Control-Allow-Credentials","true"),(f=r.exposeHeaders)!=null&&f.length&&l("Access-Control-Expose-Headers",r.exposeHeaders.join(",")),a.req.method==="OPTIONS"){r.origin!=="*"&&l("Vary","Origin"),r.maxAge!=null&&l("Access-Control-Max-Age",r.maxAge.toString());const u=await n(a.req.header("origin")||"",a);u.length&&l("Access-Control-Allow-Methods",u.join(","));let g=r.allowHeaders;if(!(g!=null&&g.length)){const w=a.req.header("Access-Control-Request-Headers");w&&(g=w.split(/\s*,\s*/))}return g!=null&&g.length&&(l("Access-Control-Allow-Headers",g.join(",")),a.res.headers.append("Vary","Access-Control-Request-Headers")),a.res.headers.delete("Content-Length"),a.res.headers.delete("Content-Type"),new Response(null,{headers:a.res.headers,status:204,statusText:"No Content"})}await h(),r.origin!=="*"&&a.header("Vary","Origin",{append:!0})}},tr=/^\s*(?:text\/(?!event-stream(?:[;\s]|$))[^;\s]+|application\/(?:javascript|json|xml|xml-dtd|ecmascript|dart|postscript|rtf|tar|toml|vnd\.dart|vnd\.ms-fontobject|vnd\.ms-opentype|wasm|x-httpd-php|x-javascript|x-ns-proxy-autoconfig|x-sh|x-tar|x-virtualbox-hdd|x-virtualbox-ova|x-virtualbox-ovf|x-virtualbox-vbox|x-virtualbox-vdi|x-virtualbox-vhd|x-virtualbox-vmdk|x-www-form-urlencoded)|font\/(?:otf|ttf)|image\/(?:bmp|vnd\.adobe\.photoshop|vnd\.microsoft\.icon|vnd\.ms-dds|x-icon|x-ms-bmp)|message\/rfc822|model\/gltf-binary|x-shader\/x-fragment|x-shader\/x-vertex|[^;\s]+?\+(?:json|text|xml|yaml))(?:[;\s]|$)/i,Be=(e,t=sr)=>{const r=/\.([a-zA-Z0-9]+?)$/,s=e.match(r);if(!s)return;let n=t[s[1]];return n&&n.startsWith("text")&&(n+="; charset=utf-8"),n},rr={aac:"audio/aac",avi:"video/x-msvideo",avif:"image/avif",av1:"video/av1",bin:"application/octet-stream",bmp:"image/bmp",css:"text/css",csv:"text/csv",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",gz:"application/gzip",htm:"text/html",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",map:"application/json",mid:"audio/x-midi",midi:"audio/x-midi",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",pdf:"application/pdf",png:"image/png",rtf:"application/rtf",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",wasm:"application/wasm",webm:"video/webm",weba:"audio/webm",webmanifest:"application/manifest+json",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xml:"application/xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2",gltf:"model/gltf+json",glb:"model/gltf-binary"},sr=rr,nr=(...e)=>{let t=e.filter(n=>n!=="").join("/");t=t.replace(new RegExp("(?<=\\/)\\/+","g"),"");const r=t.split("/"),s=[];for(const n of r)n===".."&&s.length>0&&s.at(-1)!==".."?s.pop():n!=="."&&s.push(n);return s.join("/")||"."},pt={br:".br",zstd:".zst",gzip:".gz"},ir=Object.keys(pt),ar="index.html",or=e=>{const t=e.root??"./",r=e.path,s=e.join??nr;return async(n,i)=>{var f,u,g,w;if(n.finalized)return i();let a;if(e.path)a=e.path;else try{if(a=decodeURIComponent(n.req.path),/(?:^|[\/\\])\.\.(?:$|[\/\\])/.test(a))throw new Error}catch{return await((f=e.onNotFound)==null?void 0:f.call(e,n.req.path,n)),i()}let h=s(t,!r&&e.rewriteRequestPath?e.rewriteRequestPath(a):a);e.isDir&&await e.isDir(h)&&(h=s(h,ar));const l=e.getContent;let c=await l(h,n);if(c instanceof Response)return n.newResponse(c.body,c);if(c){const y=e.mimes&&Be(h,e.mimes)||Be(h);if(n.header("Content-Type",y||"application/octet-stream"),e.precompressed&&(!y||tr.test(y))){const C=new Set((u=n.req.header("Accept-Encoding"))==null?void 0:u.split(",").map(x=>x.trim()));for(const x of ir){if(!C.has(x))continue;const R=await l(h+pt[x],n);if(R){c=R,n.header("Content-Encoding",x),n.header("Vary","Accept-Encoding",{append:!0});break}}}return await((g=e.onFound)==null?void 0:g.call(e,h,n)),n.body(c)}await((w=e.onNotFound)==null?void 0:w.call(e,h,n)),await i()}},cr=async(e,t)=>{let r;t&&t.manifest?typeof t.manifest=="string"?r=JSON.parse(t.manifest):r=t.manifest:typeof __STATIC_CONTENT_MANIFEST=="string"?r=JSON.parse(__STATIC_CONTENT_MANIFEST):r=__STATIC_CONTENT_MANIFEST;let s;t&&t.namespace?s=t.namespace:s=__STATIC_CONTENT;const n=r[e]||e;if(!n)return null;const i=await s.get(n,{type:"stream"});return i||null},lr=e=>async function(r,s){return or({...e,getContent:async i=>cr(i,{manifest:e.manifest,namespace:e.namespace?e.namespace:r.env?r.env.__STATIC_CONTENT:void 0})})(r,s)},hr=e=>lr(e);const K=new dt;K.use("/api/*",er());K.use("/static/*",hr({root:"./public"}));K.get("/",e=>e.html(`
    <!DOCTYPE html>
    <html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>스크린샷 자동 생성 도구</title>
        <script src="https://cdn.tailwindcss.com"><\/script>
        <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    </head>
    <body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-8">
        <div class="max-w-5xl mx-auto">
            <div class="bg-white rounded-xl shadow-2xl p-8">
                <h1 class="text-4xl font-bold text-gray-800 mb-3 flex items-center">
                    <i class="fas fa-camera text-indigo-600 mr-3"></i>
                    스크린샷 자동 생성 도구
                </h1>
                <p class="text-gray-600 mb-8">여러 URL의 전체 페이지 스크린샷을 한 번에 생성하세요</p>

                <!-- URL 입력 영역 -->
                <div class="mb-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-link mr-2"></i>URL 목록 (한 줄에 하나씩)
                    </label>
                    <textarea 
                        id="urlInput" 
                        rows="8" 
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm"
                        placeholder="https://example.com&#10;https://another-site.com&#10;https://third-site.com"
                    ></textarea>
                    <p class="text-xs text-gray-500 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>
                        각 URL은 새 줄로 구분하세요
                    </p>
                </div>

                <!-- 옵션 설정 -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-tv mr-2"></i>화면 너비
                        </label>
                        <select id="widthSelect" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                            <option value="1920">Desktop (1920px)</option>
                            <option value="1366">Laptop (1366px)</option>
                            <option value="768">Tablet (768px)</option>
                            <option value="375">Mobile (375px)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-file-image mr-2"></i>이미지 포맷
                        </label>
                        <select id="formatSelect" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                            <option value="png">PNG (고품질)</option>
                            <option value="jpeg">JPEG (작은 용량)</option>
                            <option value="webp">WebP (최적화)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-expand-arrows-alt mr-2"></i>캡처 모드
                        </label>
                        <select id="fullPageSelect" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                            <option value="true">전체 페이지</option>
                            <option value="false">첫 화면만</option>
                        </select>
                    </div>
                </div>

                <!-- 실행 버튼 -->
                <button 
                    id="startBtn" 
                    onclick="startScreenshots()"
                    class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-lg transition duration-200 flex items-center justify-center text-lg shadow-lg"
                >
                    <i class="fas fa-play-circle mr-3 text-xl"></i>
                    스크린샷 생성 시작
                </button>

                <!-- 진행 상태 -->
                <div id="progressSection" class="mt-8 hidden">
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-tasks mr-2 text-indigo-600"></i>
                            진행 상태
                        </h3>
                        <div class="mb-4">
                            <div class="flex justify-between text-sm text-gray-600 mb-2">
                                <span id="progressText">0 / 0 완료</span>
                                <span id="progressPercent">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
                                <div id="progressBar" class="bg-gradient-to-r from-indigo-500 to-purple-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>
                        <div id="logContainer" class="bg-white rounded border border-gray-200 p-4 max-h-64 overflow-y-auto font-mono text-xs">
                            <div class="text-gray-500">로그가 여기에 표시됩니다...</div>
                        </div>
                    </div>
                </div>

                <!-- 결과 영역 -->
                <div id="resultsSection" class="mt-8 hidden">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-images mr-2 text-green-600"></i>
                        생성된 스크린샷
                    </h3>
                    <div id="resultsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- 결과가 여기에 추가됩니다 -->
                    </div>
                </div>
            </div>

            <!-- 사용 안내 -->
            <div class="mt-8 bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-bold text-gray-800 mb-3 flex items-center">
                    <i class="fas fa-question-circle text-blue-600 mr-2"></i>
                    사용 방법
                </h3>
                <ul class="space-y-2 text-gray-700">
                    <li class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                        <span>URL 목록 입력란에 스크린샷을 찍고 싶은 웹사이트 주소를 한 줄에 하나씩 입력하세요</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                        <span>화면 크기, 이미지 포맷, 캡처 모드를 선택하세요</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                        <span>"스크린샷 생성 시작" 버튼을 클릭하면 자동으로 모든 URL의 스크린샷이 생성됩니다</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mr-3 mt-1"></i>
                        <span>완료된 스크린샷은 개별적으로 다운로드하거나 일괄 다운로드할 수 있습니다</span>
                    </li>
                </ul>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"><\/script>
        <script src="/static/app.js"><\/script>
    </body>
    </html>
  `));K.post("/api/screenshot",async e=>{var t,r;try{const{url:s,width:n=1920,format:i="png",fullPage:a=!0}=await e.req.json();if(!s)return e.json({error:"URL이 필요합니다"},400);const h="https://api.microlink.io",l=new URLSearchParams({url:s,screenshot:"true",meta:"false",viewport:JSON.stringify({width:n,height:1080}),fullPage:a.toString(),type:i}),c=await fetch(`${h}?${l.toString()}`);if(!c.ok)throw new Error(`스크린샷 API 오류: ${c.status}`);const f=await c.json();if(f.status!=="success"||!((r=(t=f.data)==null?void 0:t.screenshot)!=null&&r.url))throw new Error("스크린샷 URL을 가져올 수 없습니다");const u=await fetch(f.data.screenshot.url);if(!u.ok)throw new Error("스크린샷 이미지를 다운로드할 수 없습니다");const g=await u.arrayBuffer(),w=`screenshots/${Date.now()}-${Math.random().toString(36).substring(7)}.${i}`,{env:y}=e;return y.SCREENSHOTS&&await y.SCREENSHOTS.put(w,g,{httpMetadata:{contentType:`image/${i}`}}),e.json({success:!0,url:s,fileName:w,size:g.byteLength,timestamp:new Date().toISOString()})}catch(s){return console.error("스크린샷 생성 오류:",s),e.json({error:"스크린샷 생성 중 오류가 발생했습니다",details:s instanceof Error?s.message:String(s)},500)}});K.post("/api/screenshots/batch",async e=>{var t,r;try{const{urls:s,width:n=1920,format:i="png",fullPage:a=!0}=await e.req.json();if(!s||!Array.isArray(s)||s.length===0)return e.json({error:"URL 목록이 필요합니다"},400);const h=[];for(const l of s)try{const c="https://api.microlink.io",f=new URLSearchParams({url:l,screenshot:"true",meta:"false",viewport:JSON.stringify({width:n,height:1080}),fullPage:a.toString(),type:i}),u=await fetch(`${c}?${f.toString()}`);if(u.ok){const g=await u.json();if(g.status==="success"&&((r=(t=g.data)==null?void 0:t.screenshot)!=null&&r.url)){const y=await(await fetch(g.data.screenshot.url)).arrayBuffer(),C=`screenshots/${Date.now()}-${Math.random().toString(36).substring(7)}.${i}`,{env:x}=e;x.SCREENSHOTS&&await x.SCREENSHOTS.put(C,y,{httpMetadata:{contentType:`image/${i}`}}),h.push({success:!0,url:l,fileName:C,size:y.byteLength})}else h.push({success:!1,url:l,error:"스크린샷 URL을 가져올 수 없습니다"})}else h.push({success:!1,url:l,error:`API 오류: ${u.status}`})}catch(c){h.push({success:!1,url:l,error:c instanceof Error?c.message:String(c)})}return e.json({success:!0,total:s.length,succeeded:h.filter(l=>l.success).length,failed:h.filter(l=>!l.success).length,results:h})}catch(s){return console.error("일괄 스크린샷 생성 오류:",s),e.json({error:"일괄 스크린샷 생성 중 오류가 발생했습니다",details:s instanceof Error?s.message:String(s)},500)}});K.get("/api/screenshot/:fileName",async e=>{var t;try{const r=e.req.param("fileName"),{env:s}=e;if(!s.SCREENSHOTS)return e.json({error:"R2 bucket이 설정되지 않았습니다"},500);const n=await s.SCREENSHOTS.get(`screenshots/${r}`);return n?new Response(n.body,{headers:{"Content-Type":((t=n.httpMetadata)==null?void 0:t.contentType)||"image/png","Cache-Control":"public, max-age=31536000"}}):e.notFound()}catch(r){return console.error("스크린샷 조회 오류:",r),e.json({error:"스크린샷을 불러올 수 없습니다"},500)}});K.get("/api/screenshots",async e=>{try{const{env:t}=e;if(!t.SCREENSHOTS)return e.json({error:"R2 bucket이 설정되지 않았습니다"},500);const s=(await t.SCREENSHOTS.list({prefix:"screenshots/"})).objects.map(n=>({key:n.key,fileName:n.key.replace("screenshots/",""),size:n.size,uploaded:n.uploaded}));return e.json({success:!0,count:s.length,screenshots:s})}catch(t){return console.error("스크린샷 목록 조회 오류:",t),e.json({error:"스크린샷 목록을 불러올 수 없습니다"},500)}});const We=new dt,fr=Object.assign({"/src/index.tsx":K});let gt=!1;for(const[,e]of Object.entries(fr))e&&(We.all("*",t=>{let r;try{r=t.executionCtx}catch{}return e.fetch(t.req.raw,t.env,r)}),We.notFound(t=>{let r;try{r=t.executionCtx}catch{}return e.fetch(t.req.raw,t.env,r)}),gt=!0);if(!gt)throw new Error("Can't import modules from ['/src/index.ts','/src/index.tsx','/app/server.ts']");export{We as default};
